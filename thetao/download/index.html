<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>《Ancient Domain Tao Shadow》Download page</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="icon" href="../moban_files/favicon.ico">
    <link rel="stylesheet" type="text/css" href="../moban_files/common.css">
    <link rel="stylesheet" type="text/css" href="../moban_files/style.css">
    <script type="text/javascript" src="../moban_files/jquery.js"></script>
    <style type="text/css">
        html,
        body,
        .warp {
            height: 100%;
        }
    </style>
</head>

<body>
    <div class="warp">
        <div class="transfer">
            <img class="download-tips hid" src="../moban_files/transfer_ios.png" alt="">
            <img class="download-bg" src="../moban_files/down_qr.jpg" alt="">
        </div>
    </div>
    <script>
        var download1 = { "url": "https://play.google.com/store/apps/details?id=io.github.firewingstudio.taoshadow", "type": "android", "id": "", "bg": "", "tips": 1 };

        var download2 = { "url": "", "type": "ios", "id": "", "bg": "", "tips": 2 };
    </script>

    <script type="text/javascript">
        var ua = window.navigator.userAgent.toLowerCase();
        function isWeiXin() {
            if (ua.match(/MicroMessenger/i) == 'micromessenger') {
                return true;
            } else {
                return false;
            }
        }
        function isWeibo() {
            if (ua.indexOf("weibo") > 0) {
                return true;
            } else {
                return false;
            }
        }
        window.onload = function () {
            // $.ajax({
            //     dataType: "jsonp",
            //     jsonp: "jsonpcallback",
            //     url: "",
            //     data: {
            //         "code": download.id,
            //         "mobileDownload.osType": download.type,
            //         "mobileDownload.client": "mobile"
            //     }
            // });

            if (isWeibo()) {
                //微博访问，提示用外部浏览器打开
                $('.download-tips').removeClass('hid');
            }

            if (isWeiXin() && download.tips == 1) {
                //微信访问且下载地址是apk，提示用外部浏览器打开
                $('.download-tips').removeClass('hid');
            } else {
                $('.download-bg').removeClass('hid');

                //非微信访问，直接推送地址
                // window.location.href = download.url;

                let u = navigator.userAgent;
                if (u.indexOf("Android") > -1 || u.indexOf("Linux") > -1) {
                    console.log("安卓");
                    window.location.href = download1.url;
                } else if (u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)) {
                    console.log("IOS");
                    if (download2.url === "") {
                        document.getElementById('donateModal').style.display = 'block';
                        if (window.outerWidth >= 450) {
                            document.getElementById('donateModal').style.minWidth = '410px';
                        }
                        return;
                    }
                    window.location.href = download2.url;
                }
            }
        }
    </script>

    <!-- <script type="text/javascript">
        if (!share_opts) {
            // 分享配置
            var share_opts = {
                title: '火翼游戏平台 - 游戏发烧友的聚集地！',
                desc: '真正有趣好玩的游戏都在这里',
                img: '../moban_files/share_icon.jpg',
                url: location.href.split('#')[0],
                key: 'game_index'
            };
        }
        weixin_jssdk_ops.init(share_opts);
    </script> -->

    <style>
        #donateModal {
            display: none; /* 默认隐藏 */
            position: fixed; /* 固定位置 */
            z-index: 1; /* 置于顶层 */
            left: 50%;
            top: 45%;
            transform: translate(-50%, -50%);
            width: auto; /* 宽度 */
            height: auto; /* 高度 */
            overflow: auto; /* 如果需要滚动条 */
            background-color: rgba(0,0,0,0.7); /* 背景颜色，带透明度 */
            padding: 1vw;
            line-height: 1.2;
            font-size: small;
            min-height: 330px;
            color: #c7c7c8;
        }
    </style>

    <script>
        function closeModal() {
            document.getElementById('donateModal').style.display = 'none';
        }
    </script>

    <div id="donateModal" style="display:none;">
        <!-- 捐赠页面的内容 -->
        <h2>Donate for iOS</h2>
        <br/>
        <p><b>Support Firewings Game Studio</b></p>
        <p><b>Ancient Domain Tao Shadow</b> is now live on <b>Google Play!</b></p>
        <p>The iOS version is currently in development and coming soon.</p>
        <p>🔥 Support us by playing, sharing, or sponsoring.</p>
        <br/>
        <!-- 例如，支付宝、微信支付二维码 -->
        <p>Alipay</p>
        <img src="../moban_files/alipay_qr.png" alt="支付宝捐赠">
        &nbsp;&nbsp;&nbsp;&nbsp;
        <img src="../moban_files/wechatpay_qr.png" alt="微信捐赠">
        <div style="display: flex; justify-content: flex-end; margin-top: -212px;"><p>WeChatPay</p></div>
        <button style="position: absolute;top:2vw;right:1vw;" onclick="closeModal()">CLOSE</button>
    </div>


</body>

</html>